<!DOCTYPE html>
<html>
<head>
    <title>Debug Payment Intent</title>
</head>
<body>
    <h1>Debug Payment Intent API</h1>
    <button onclick="testPayment()">Test Payment Intent</button>
    <pre id="result"></pre>

    <script>
        async function testPayment() {
            const data = {
                items: [
                    {
                        variantId: "cm4b3vdvk00013buypfcqc1zv", // Use a real-looking variant ID
                        quantity: 1,
                        price: 29.99
                    }
                ],
                shippingAddress: {
                    firstName: "John",
                    lastName: "Doe",
                    email: "john@example.com",
                    phone: "+447123456789",
                    address1: "123 Military Street",
                    address2: "",
                    city: "London",
                    postcode: "SW1A 1AA",
                    country: "GB"
                },
                billingAddress: {
                    firstName: "John",
                    lastName: "Doe",
                    address1: "123 Military Street",
                    address2: "",
                    city: "London",
                    postcode: "SW1A 1AA",
                    country: "GB"
                }
            };

            try {
                console.log('Sending:', JSON.stringify(data, null, 2));
                
                const response = await fetch('/api/payment-intent', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.text();
                console.log('Status:', response.status);
                console.log('Response:', result);
                
                document.getElementById('result').textContent = 
                    `Status: ${response.status}\n\nResponse: ${result}\n\nSent Data: ${JSON.stringify(data, null, 2)}`;
                    
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('result').textContent = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>