<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Confirmed - Military Tees UK</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .success-container {
            min-height: 100vh;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 2rem 1rem;
        }
        
        .success-content {
            max-width: 800px;
            margin: 0 auto;
            background: var(--background);
            border: 2px solid var(--border);
            padding: 3rem;
            text-align: center;
            box-shadow: var(--shadow-large);
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            background: var(--success);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 2rem;
            font-size: 2.5rem;
        }
        
        .success-title {
            font-family: 'Staatliches', sans-serif;
            color: var(--military-green);
            font-size: 2.5rem;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 1rem;
        }
        
        .success-message {
            color: var(--text-muted);
            font-size: 1.1rem;
            margin-bottom: 2rem;
            line-height: 1.6;
        }
        
        .order-details {
            background: #f8f9fa;
            border: 1px solid var(--border);
            padding: 2rem;
            margin: 2rem 0;
            text-align: left;
        }
        
        .order-number {
            font-family: 'Staatliches', sans-serif;
            color: var(--military-green);
            font-size: 1.3rem;
            font-weight: 700;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 1rem;
        }
        
        .next-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .step-card {
            background: var(--background);
            border: 1px solid var(--border);
            padding: 1.5rem;
            text-align: center;
        }
        
        .step-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }
        
        .step-title {
            font-weight: 600;
            color: var(--military-green);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
        }
        
        .step-description {
            color: var(--text-muted);
            font-size: 0.85rem;
        }
        
        .action-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 2rem;
        }
        
        @media (max-width: 768px) {
            .success-content {
                padding: 2rem 1rem;
            }
            
            .success-title {
                font-size: 2rem;
            }
            
            .action-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .next-steps {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="success-container">
        <div class="success-content">
            <div class="success-icon">
                ‚úÖ
            </div>
            
            <h1 class="success-title">Order Confirmed!</h1>
            
            <p class="success-message">
                Thank you for your order! Your mission gear is being prepared for deployment.
                <br>A confirmation email has been sent to <strong id="customer-email">your email address</strong>.
            </p>
            
            <div class="order-details" id="order-details">
                <div class="order-number">
                    Order #<span id="order-number">Loading...</span>
                </div>
                <div class="order-info">
                    <p><strong>Order Date:</strong> <span id="order-date">Loading...</span></p>
                    <p><strong>Total:</strong> <span id="order-total">Loading...</span></p>
                    <p><strong>Delivery Method:</strong> <span id="delivery-method">Loading...</span></p>
                    <p><strong>Estimated Delivery:</strong> <span id="estimated-delivery">Loading...</span></p>
                </div>
            </div>
            
            <div class="next-steps">
                <div class="step-card">
                    <div class="step-icon">üìß</div>
                    <div class="step-title">Order Confirmation</div>
                    <div class="step-description">Check your email for order confirmation and receipt</div>
                </div>
                
                <div class="step-card">
                    <div class="step-icon">üì¶</div>
                    <div class="step-title">Processing</div>
                    <div class="step-description">Order packed and dispatched within 24 hours</div>
                </div>
                
                <div class="step-card">
                    <div class="step-icon">üöö</div>
                    <div class="step-title">Delivery</div>
                    <div class="step-description">Track your package once shipped</div>
                </div>
            </div>
            
            <div class="trust-signals">
                <div class="trust-signal">
                    <span class="trust-icon">üîí</span>
                    <span>Your payment was processed securely</span>
                </div>
                <div class="trust-signal">
                    <span class="trust-icon">‚Ü©Ô∏è</span>
                    <span>30-day money back guarantee</span>
                </div>
                <div class="trust-signal">
                    <span class="trust-icon">üìû</span>
                    <span>Customer support available 7 days a week</span>
                </div>
            </div>
            
            <div class="action-buttons">
                <a href="/categories" class="btn btn-primary">Continue Shopping</a>
                <a href="/account/orders" class="btn btn-secondary">Track Your Order</a>
                <button onclick="window.print()" class="btn btn-outline">Print Receipt</button>
            </div>
        </div>
    </div>
    
    <script>
        // Parse order information from URL parameters or localStorage
        function displayOrderInfo() {
            const urlParams = new URLSearchParams(window.location.search);
            const paymentIntent = urlParams.get('payment_intent');
            const sessionId = urlParams.get('session_id');
            
            // Try to get order info from localStorage (set by checkout)
            const orderInfo = localStorage.getItem('orderConfirmation');
            
            if (orderInfo) {
                try {
                    const order = JSON.parse(orderInfo);
                    
                    // Basic order info
                    document.getElementById('order-number').textContent = order.orderNumber || 'MTU-' + Date.now().toString().slice(-6);
                    document.getElementById('order-date').textContent = order.orderDate || new Date().toLocaleDateString('en-GB');
                    document.getElementById('order-total').textContent = '¬£' + (order.total || '0.00');
                    document.getElementById('customer-email').textContent = order.customerEmail || 'your email address';
                    
                    // Delivery information
                    const deliveryNames = {
                        'standard': 'Standard Delivery (3-5 business days)',
                        'express': 'Express Delivery (1 business day)',
                        'premium': 'Premium Delivery (1-2 business days)'
                    };
                    document.getElementById('delivery-method').textContent = deliveryNames[order.deliveryMethod] || 'Standard Delivery';
                    document.getElementById('estimated-delivery').textContent = order.estimatedDelivery || calculateEstimatedDelivery('standard');
                    
                    // Add detailed order breakdown if available
                    if (order.items && order.items.length > 0) {
                        displayOrderItems(order);
                    }
                    
                    if (order.shippingAddress) {
                        displayShippingAddress(order.shippingAddress);
                    }
                    
                    // Clear the stored order info after displaying
                    localStorage.removeItem('orderConfirmation');
                } catch (error) {
                    console.error('Error parsing order info:', error);
                    setDefaultOrderInfo();
                }
            } else {
                setDefaultOrderInfo();
            }
        }
        
        function displayOrderItems(order) {
            const orderDetailsDiv = document.getElementById('order-details');
            if (!orderDetailsDiv) return;
            
            // Create items section
            const itemsHTML = `
                <div class="order-items-section" style="margin-top: 2rem; padding: 1.5rem; background: #f8f9fa; border: 1px solid var(--border);">
                    <h3 style="color: var(--military-green); margin-bottom: 1rem; font-family: 'Staatliches', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Order Items</h3>
                    <div class="items-list">
                        ${order.items.map(item => `
                            <div style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 0; border-bottom: 1px solid #ddd;">
                                <div>
                                    <div style="font-weight: 600; color: var(--text);">${item.name}</div>
                                    <div style="font-size: 0.85rem; color: var(--text-muted);">
                                        ${item.size ? `Size: ${item.size}` : ''} 
                                        ${item.size && item.color ? ' ‚Ä¢ ' : ''}
                                        ${item.color ? `Color: ${item.color}` : ''}
                                    </div>
                                    <div style="font-size: 0.85rem; color: var(--text-muted);">Quantity: ${item.quantity}</div>
                                </div>
                                <div style="font-weight: 700; color: var(--military-green);">¬£${(item.price * item.quantity).toFixed(2)}</div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 2px solid var(--border);">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>Subtotal:</span>
                            <span>¬£${order.subtotal}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>Shipping:</span>
                            <span>¬£${order.shipping}</span>
                        </div>
                        ${order.discount && parseFloat(order.discount) > 0 ? `
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem; color: #28a745;">
                            <span>Discount ${order.appliedPromo ? `(${order.appliedPromo.code})` : ''}:</span>
                            <span>-¬£${order.discount}</span>
                        </div>
                        ` : ''}
                        <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                            <span>VAT (20%):</span>
                            <span>¬£${order.tax}</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 1.1rem; color: var(--military-green); border-top: 2px solid var(--military-green); padding-top: 0.5rem; margin-top: 0.5rem;">
                            <span>Total:</span>
                            <span>¬£${order.total}</span>
                        </div>
                    </div>
                </div>
            `;
            
            orderDetailsDiv.insertAdjacentHTML('beforeend', itemsHTML);
        }
        
        function displayShippingAddress(address) {
            const orderDetailsDiv = document.getElementById('order-details');
            if (!orderDetailsDiv) return;
            
            const addressHTML = `
                <div class="shipping-address-section" style="margin-top: 2rem; padding: 1.5rem; background: #e8f5e8; border: 1px solid #c3e6c3;">
                    <h3 style="color: var(--military-green); margin-bottom: 1rem; font-family: 'Staatliches', sans-serif; text-transform: uppercase; letter-spacing: 1px;">Shipping Address</h3>
                    <div style="line-height: 1.6;">
                        <div style="font-weight: 600;">${address.firstName} ${address.lastName}</div>
                        <div>${address.address1}</div>
                        ${address.address2 ? `<div>${address.address2}</div>` : ''}
                        <div>${address.city}, ${address.postcode}</div>
                        <div style="text-transform: uppercase;">${address.country || 'GB'}</div>
                        ${address.phone ? `<div style="margin-top: 0.5rem; color: var(--text-muted);">Phone: ${address.phone}</div>` : ''}
                    </div>
                </div>
            `;
            
            orderDetailsDiv.insertAdjacentHTML('beforeend', addressHTML);
        }
        
        function calculateEstimatedDelivery(method) {
            const days = method === 'express' ? 1 : method === 'premium' ? 2 : 5;
            const date = new Date();
            date.setDate(date.getDate() + days);
            return date.toLocaleDateString('en-GB');
        }
        
        function setDefaultOrderInfo() {
            // Set default values if no order info available
            document.getElementById('order-number').textContent = 'MTU-' + Date.now().toString().slice(-6);
            document.getElementById('order-date').textContent = new Date().toLocaleDateString('en-GB');
            document.getElementById('order-total').textContent = 'Check email';
            document.getElementById('delivery-method').textContent = 'Standard Delivery';
            document.getElementById('estimated-delivery').textContent = '3-5 business days';
            document.getElementById('customer-email').textContent = 'your email address';
        }
        
        // Load order info when page loads
        document.addEventListener('DOMContentLoaded', displayOrderInfo);
    </script>
</body>
</html>